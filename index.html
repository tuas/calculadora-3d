<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Costos de Impresión</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script> <!-- Biblioteca para manejar Excel -->
</head>
<body>
    <div class="container">
        <!-- Formulario -->
        <form id="calculadoraForm">
            <label for="nombreConsulta">Nombre de la Consulta:</label>
            <input type="text" id="nombreConsulta" name="nombreConsulta" required>

            <label for="tipoMaquina">Tipo de Máquina Usada:</label>
            <input type="text" id="tipoMaquina" name="tipoMaquina" required>

            <label for="precioKG">Precio por KG (€):</label>
            <input type="number" id="precioKG" name="precioKG" required>

            <label for="precioKwh">Precio por KWh (€):</label>
            <input type="number" id="precioKwh" name="precioKwh" required>

            <label for="consumoReal">Consumo Real (W):</label>
            <input type="number" id="consumoReal" name="consumoReal" required>

            <label for="desgasteMaquina">Desgaste Máquina (horas):</label>
            <input type="number" id="desgasteMaquina" name="desgasteMaquina" required>

            <label for="precioRepuestos">Precio Repuestos (€):</label>
            <input type="number" id="precioRepuestos" name="precioRepuestos" required>

            <label for="margenError">Margen de Error (%):</label>
            <input type="number" id="margenError" name="margenError" required>

            <label for="horasImpresion">Horas de Impresión:</label>
            <input type="number" id="horasImpresion" name="horasImpresion" required>

            <label for="gramosFilamento">Gramos de Filamento:</label>
            <input type="number" id="gramosFilamento" name="gramosFilamento" required>

            <label for="margenGanancia">Margen de Ganancia (%):</label>
            <input type="number" id="margenGanancia" name="margenGanancia" required>

            <button type="button" class="calcular" onclick="calculate()">Calcular</button>
        </form>

        <!-- Resultados -->
        <div id="resultados">
            <h2>Resultados</h2>
            <label for="precioMaterial">Precio Material (€):</label>
            <input type="text" id="precioMaterial" readonly>

            <label for="precioLuz">Precio Luz (€):</label>
            <input type="text" id="precioLuz" readonly>

            <label for="desgasteMaquinaResult">Desgaste Máquina (€):</label>
            <input type="text" id="desgasteMaquinaResult" readonly>

            <label for="margenErrorResult">Margen de Error (€):</label>
            <input type="text" id="margenErrorResult" readonly>

            <label for="costo">Costo Total (€):</label>
            <input type="text" id="costo" readonly>

            <label for="totalCobrar">Total a Cobrar (€):</label>
            <input type="text" id="totalCobrar" readonly>

            <button type="button" class="guardar-tabla" onclick="guardarEnTabla()">Guardar en Tabla</button>
        </div>

        <!-- Tabla -->
        <div id="tabla">
            <h2>Tabla</h2>
            <table id="tablaDatos">
                <thead>
                    <tr>
                        <th>Nombre Consulta</th>
                        <th>Tipo Máquina</th>
                        <th>Precio KWh</th>
                        <th>Consumo Real</th>
                        <th>Horas Impresión</th>
                        <th>Gramos Filamento</th>
                        <th>Fecha Consulta</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Filas de la tabla se agregarán aquí -->
                </tbody>
            </table>
        </div>

        <!-- Sección de Cargar/Descargar -->
        <div id="cargar-descargar">
            <input type="file" id="cargarArchivo" accept=".xlsx, .csv" style="display: none;">
            <button class="cargar" onclick="document.getElementById('cargarArchivo').click()">Cargar Tabla</button>
            <button class="guardar" onclick="guardarTablaExcel()">Descargar Tabla</button>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
